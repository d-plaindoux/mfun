<!doctype html>
<html lang="fr">
<head>
    <script type="application/mfun">

    def setDom { n v     -> native "set"   }
    def getDom { n       -> native "get"   }

    def leq    { l r t f -> native "leq"   }
    def plus   { l r     -> native "plus" }
    def mult   { l r     -> native "mult"  }
    def minus  { l r     -> native "minus" }

    </script>

    <script type="application/mfun">

    def change { n v -> do { setDom (getDom n) v } return { v } }

    def cond   { c t f -> c t f () }

    def do     { f   -> then () f }
    def then   { v f -> { v c -> c v } $ f v }
    def return { v f  -> f v }

    </script>

    <script type="application/mfun">

    def fact { a ->
        cond (leq a 1)
             { 1 }
             { mult a $ fact $ minus a 1 }
    }

    def compute_display { v ->
        do   { change "val" v }
        then { change "fact" $ fact v }
        return { v }
    }

    do   { compute_display 1 }
    then { compute_display $ plus _ 1 }
    then { compute_display $ plus _ 1 }
    then { compute_display $ plus _ 1 }
    return { _ }

    </script>
    <script type="application/javascript" src="../dist/mFun.min.js"></script>
    <script type="application/javascript">
        function bootstrap() {
            mFun.default.repl(mFun.default.reader.browser)
        }
    </script>
</head>
<body onload="bootstrap()">
<div>
    <h1>Factorial(<span id='val'>...</span>) = <span id='fact'>...</span></h1>
</div>
</body>
</html>